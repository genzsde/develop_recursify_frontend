<div class="dashboard-container">
  <header class="topbar bento-card header-accent">
    <div class="welcome-text">
      <h2>Welcome back, <span>{{ userName }}</span></h2>
      <p class="subtitle">You have {{ questions.length }} questions tracked.</p>
    </div>
    <div class="header-actions">
      <button class="btn-primary" (click)="goToAddQuestion()">â• Add Question</button>
      <button class="btn-secondary" (click)="goToTodayQuestion()">ğŸ“… Today's Question</button>
      <button class="btn-logout" (click)="logout()">Logout</button>
    </div>
  </header>

  <main class="content-grid">
    <div class="status-box" *ngIf="loading">
      <span class="loader"></span> Fetching questions...
    </div>
    <div class="error-box" *ngIf="error">âš ï¸ {{ error }}</div>

    <div class="bento-grid" *ngIf="!loading && !error">
      <section class="bento-card question-card"
               *ngFor="let q of questions;
               let i = index"
               [class.wide]="i % 0 === 0"
               [class.tall]="i % 0 === 0">

        <div class="card-header">
          <span class="qno">#{{ q.questionNumber }}</span>
          <span class="difficulty-pill" [ngClass]="q.difficulty.toLowerCase()">
            {{ q.difficulty }}
          </span>
        </div>

        <div class="card-body">
          <h3 class="title">{{ q.title }}</h3>
          <p class="description">{{ q.description }}</p>
        </div>

        <div class="meta-info">
          <div class="meta-item">
            <span class="icon">ğŸ“…</span>
            <small>Next: {{ q.nextRevisionDate | date:'mediumDate' }}</small>
          </div>
          <div class="meta-item">
            <span class="icon">âœ…</span>
            <small>Solved: {{ q.solveCount }}</small>
          </div>
        </div>

        <div class="card-footer">
          <a class="external-link" [href]="q.link" target="_blank">View â†—</a>
          <div class="action-group">
            <button class="btn-icon update" (click)="updateQuestion(q.id)" title="Update">ğŸ”ƒ</button>
            <button class="btn-icon delete" (click)="openDeletePopup(q.id)" title="Delete">ğŸ—‘</button>
          </div>
        </div>
      </section>
    </div>

    <section class="bento-card empty-state" *ngIf="!loading && questions.length === 0">
      <p>No questions found. Start by adding one!</p>
    </section>
  </main>
</div>

<div class="modal-overlay" *ngIf="showConfirm">
  <div class="bento-card modal-card">
    <h3>Delete Question</h3>
    <p>This action cannot be undone. Are you sure?</p>
    <div class="modal-actions">
      <button class="btn-danger" (click)="confirmDelete()">Delete</button>
      <button class="btn-ghost" (click)="cancelDelete()">Cancel</button>
    </div>
  </div>
</div>
